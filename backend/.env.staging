# =============================================================================
# nself-tv Configuration - Staging Environment
# =============================================================================
# Staging configuration for testing before production.
# Deploy to: *.staging.nself.org
# =============================================================================

# -----------------------------------------------------------------------------
# 1. PROJECT BASICS
# -----------------------------------------------------------------------------
PROJECT_NAME=nself-tv
COMPOSE_PROJECT_NAME=ntv
ENV=staging
BASE_DOMAIN=staging.nself.org

# Core Services
POSTGRES_ENABLED=true
HASURA_ENABLED=true
AUTH_ENABLED=true
NGINX_ENABLED=true

# -----------------------------------------------------------------------------
# 2. POSTGRESQL DATABASE
# -----------------------------------------------------------------------------
POSTGRES_DB=nself_tv_staging
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_IN_SECRETS
POSTGRES_PORT=5432
POSTGRES_VERSION=15

# -----------------------------------------------------------------------------
# 3. HASURA GRAPHQL ENGINE
# -----------------------------------------------------------------------------
HASURA_GRAPHQL_ADMIN_SECRET=CHANGE_IN_SECRETS
HASURA_PORT=8080
HASURA_VERSION=v2.38.0
HASURA_CONSOLE=false
HASURA_DEV_MODE=false
HASURA_UNAUTHORIZED_ROLE=anonymous

# JWT Configuration (shared with Auth service)
HASURA_JWT_SECRET=CHANGE_IN_SECRETS

# -----------------------------------------------------------------------------
# 4. AUTHENTICATION (nhost-auth)
# -----------------------------------------------------------------------------
AUTH_PORT=4000
AUTH_VERSION=latest
AUTH_HOST=0.0.0.0
AUTH_JWT_SECRET=CHANGE_IN_SECRETS

# Auth providers
AUTH_GOOGLE_ENABLED=false
AUTH_GITHUB_ENABLED=false

# -----------------------------------------------------------------------------
# 5. OPTIONAL SERVICES
# -----------------------------------------------------------------------------

# Redis (caching, sessions, queues)
REDIS_ENABLED=true
REDIS_PORT=6379
REDIS_VERSION=7
REDIS_PASSWORD=CHANGE_IN_SECRETS

# MinIO (S3-compatible object storage)
MINIO_ENABLED=true
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=CHANGE_IN_SECRETS
MINIO_ROOT_PASSWORD=CHANGE_IN_SECRETS
MINIO_VERSION=latest
MINIO_BUCKET_RAW=media-raw
MINIO_BUCKET_ENCODED=media-encoded
MINIO_BUCKET_THUMBNAILS=media-thumbnails
MINIO_BUCKET_SUBTITLES=media-subtitles
MINIO_BUCKET_BACKUPS=backups

# MeiliSearch (search engine)
MEILISEARCH_ENABLED=true
MEILISEARCH_PORT=7700
MEILISEARCH_MASTER_KEY=CHANGE_IN_SECRETS
MEILISEARCH_VERSION=v1.5

# MailPit (disabled in staging - use real SMTP)
MAILPIT_ENABLED=false
SMTP_HOST=CHANGE_IN_SECRETS
SMTP_PORT=587
SMTP_USER=CHANGE_IN_SECRETS
SMTP_PASSWORD=CHANGE_IN_SECRETS
SMTP_FROM=noreply@staging.nself.org

# -----------------------------------------------------------------------------
# 6. MONITORING STACK
# -----------------------------------------------------------------------------
MONITORING_ENABLED=true

PROMETHEUS_PORT=9090
PROMETHEUS_VERSION=latest

GRAFANA_PORT=3000
GRAFANA_VERSION=latest
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_IN_SECRETS

LOKI_PORT=3100
LOKI_VERSION=2.9.0

ALERTMANAGER_PORT=9093

# -----------------------------------------------------------------------------
# 7. CUSTOM MICROSERVICES
# -----------------------------------------------------------------------------
CS_1=library_service:gin:5001
CS_2=discovery_service:gin:5002
CS_3=stream_gateway:gin:5003
CS_4=recommendation_engine:fastapi:5004
CS_5=video_processor:bullmq-js:5005
CS_6=thumbnail_generator:bullmq-js:5006
CS_7=devices:express-js:3603
CS_8=epg:express-js:3031
CS_9=sports:express-js:3035
CS_10=recording:express-js:3602

# Stream Gateway
STREAM_SIGNING_SECRET=CHANGE_IN_SECRETS

# -----------------------------------------------------------------------------
# 8. FRONTEND APPLICATIONS (External - Not in Docker)
# -----------------------------------------------------------------------------

# Web Platform (Next.js)
# Access: https://app.staging.nself.org
FRONTEND_APP_1_NAME=web
FRONTEND_APP_1_PORT=3000
FRONTEND_APP_1_ROUTE=app

# TV Platform (React Native Web)
# Access: https://tv.staging.nself.org
FRONTEND_APP_2_NAME=tv
FRONTEND_APP_2_PORT=3001
FRONTEND_APP_2_ROUTE=tv

# Mobile Platform (React Native Metro)
# Access: https://mobile.staging.nself.org
FRONTEND_APP_3_NAME=mobile
FRONTEND_APP_3_PORT=8081
FRONTEND_APP_3_ROUTE=mobile

# Desktop Platform (Tauri)
# Access: https://desktop.staging.nself.org
FRONTEND_APP_4_NAME=desktop
FRONTEND_APP_4_PORT=3002
FRONTEND_APP_4_ROUTE=desktop

# -----------------------------------------------------------------------------
# 9. APPLICATION-SPECIFIC CONFIGURATION
# -----------------------------------------------------------------------------

# Video Processing
VIDEO_TRANSCODE_FORMATS=mp4,webm,hls
VIDEO_QUALITY_LEVELS=360p,720p,1080p,4k
VIDEO_MAX_UPLOAD_SIZE=5GB

# CDN Configuration
CDN_ENABLED=false
CDN_ENDPOINT=https://cdn.staging.nself.org
CDN_CACHE_TTL=86400

# Content Moderation
MODERATION_ENABLED=true
MODERATION_AUTO_APPROVE=false

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_PROVIDER=plausible

# -----------------------------------------------------------------------------
# 10. EXTERNAL SERVICE INTEGRATIONS
# -----------------------------------------------------------------------------

# Stripe (payments)
STRIPE_ENABLED=false
STRIPE_PUBLIC_KEY=pk_test_...
STRIPE_SECRET_KEY=CHANGE_IN_SECRETS

# AWS S3 (if using instead of MinIO)
AWS_S3_ENABLED=false
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=CHANGE_IN_SECRETS
AWS_SECRET_ACCESS_KEY=CHANGE_IN_SECRETS
AWS_S3_BUCKET=nself-tv-staging-media

# -----------------------------------------------------------------------------
# SECURITY NOTES
# -----------------------------------------------------------------------------
# - All CHANGE_IN_SECRETS values must be set in .env.secrets (gitignored)
# - Never commit real credentials to git
# - Use strong passwords (32+ characters) for production
# - Enable SSL/TLS for all external endpoints
# - Review security checklist before deploying
